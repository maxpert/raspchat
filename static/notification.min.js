!function(i,t){function e(i){0===d.length&&(d=[t.title]),d.push(i),a||(a=setInterval(function(){-1===d.indexOf(t.title)&&(d[0]=t.title),t.title=d[++h%d.length]},1e3))}function n(){0!==d.length&&("external"in i&&"msSiteModeClearIconOverlay"in i.external&&i.external.msSiteModeClearIconOverlay(),clearInterval(a),a=!1,t.title=d[0],d=[])}function o(i,t,e){if(t.match(" "))for(var n=t.split(" "),c=0;c<n.length;c++)o(i,n[c],e);i.addEventListener?(i.removeEventListener(t,e,!1),i.addEventListener(t,e,!1)):(i.detachEvent("on"+t,e),i.attachEvent("on"+t,e))}function c(){return"external"in i&&"msIsSiteMode"in i.external?i.external.msIsSiteMode()?r:f:"webkitNotifications"in i?0===i.webkitNotifications.checkPermission()?r:l:"mozNotification"in i.navigator?r:f}function s(){return i.Notification.permission=c(),i.Notification.permission}var a,r="granted",l="denied",f="unknown",d=[],h=0;Object(i.Notification).permission||(o(i,"focus scroll click",n),i.Notification=function(t,o){if(!(this instanceof i.Notification))return new i.Notification(t,o);var c,s=this;if(o=o||{},this.body=o.body||"",this.icon=o.icon||"",this.lang=o.lang||"",this.tag=o.tag||"",this.close=function(){n(),Object(c).close&&c.close(),s.onclose()},this.onclick=function(){},this.onclose=function(){},e(t),"external"in i&&"msIsSiteMode"in i.external)i.external.msIsSiteMode()&&(i.external.msSiteModeActivate(),this.icon&&i.external.msSiteModeSetIconOverlay(this.icon,t));else if("webkitNotifications"in i)0===i.webkitNotifications.checkPermission()&&(c=i.webkitNotifications.createNotification(this.icon,t,this.body),c.show(),c.onclick=function(){s.onclick(),i.focus(),setTimeout(function(){c.cancel()},1e3)});else if("mozNotification"in i.navigator){var a=i.navigator.mozNotification.createNotification(t,this.body,this.icon);a.show()}},i.Notification.requestPermission=function(t){if(t=t||function(){},"external"in i&&"msIsSiteMode"in i.external){try{i.external.msIsSiteMode()||(i.external.msAddSiteMode(),t(f))}catch(e){}t(s())}else"webkitNotifications"in i?i.webkitNotifications.requestPermission(function(){t(s())}):t(s())},s())}(window,document);
